# Introduction

**Platform**: Windows, Linux(Planning)

RTMP like protocol implementation, but without complicated header, it can be used as realtime transfer.  
they are where it can be used to:  

1. realtime file transfer  

2. realtime video, like rtmp protocol, server is just transfer what he received and copy many of it to puller which is match up with packet app 
 
3. etc.  

This project has three part: pusher,server and puller  
if you familiar with rtmp protocal, it would be self-explanatory.  
**rtmp_pusher**: pushing local data to server  

**rtmp_server**: transfer data and copy it to multi-copy to many pullers  

**rtmp_puller**: pulling data from server  

# Showcase
![avatar](./showcase/2020013114584466.gif)

An example in the above gif is file transfer. Workflow is as below:  

1.Open up `rtmp_server.vcxproj`, build it, running it with release edition  

2.Open a new bash in test directory, and type in sh batch_test.sh  
you should have a look at `batch_test.sh`, which has defined a switch to mode selection(`debug` or `release`).  

you need to configure:  
- **puller_num**  
  _puller number_
- **puller_app**  
  _which appname do you want to pulling from server?_
- **dst_dir**  
  _`/path/to/place/generated/files` for place batch_test.sh generated files, and of course with pulling data contained_
- **pusher_num**  
  _pusher number_ 
- **pusher_app**  
  _what would you want to name your pushing, it always be a name which describe the pushing data type(xxx.txt,xxx.mp4,xxx.word,etc)_  
- **pusher_video_path**  
  _`/path/to/video/file`, pusher will read from it and pushing data to server_

3.Watch the statistics info show up by server(refresh every 1s)  
all the generated files and pulling data would store at `dst_dir`, every pusher would generate a directory named with `timestamp` generated by `$(date +%s%N)`  

# Directory Hierarchy
## rtmp_server
**rtmp_server/**
- **rtmp_server.cpp**
- **Log.h**
- **Log.cpp**
- **Packet.h**

## test
**test/**  
- **batch_test.sh**	  
  _for batching test_
- **clean.sh**  
  _for cleaning the files and directories generated by batch_test.sh_
- **kill.sh**  
  _for killing all accidently process spawned by batch_test.sh(if server shows up some zoombie process, you can use it to get them off)_
- **start_puller_pusher.sh**  
  _core sh_
- **start_server.sh**  
  _don't use it(it would be bizaro to show under bash),directly using the compiled exe plz._
- **test_one.sh**  
  _one test_


# TODO
- [ ] make it high stability, support more connection(more than 64)
- [ ] transplant to Linux

# BUGS
- [ ] `fd_set` can only support 64 connection, it means server supported connection maximum is 64
- [ ] `select` is not very fast, i'd like to find a better api(under Windows) like epoll(in Linux)

# Authors
- Brian Yi